<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Upload Content</title>
    <link rel="stylesheet" href="styles.css">
    <!-- Add Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.10.0/firebase-storage.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.10.0/firebase-database.js"></script>
</head>
<body>
    <div class="container">
        <h2>Upload Content</h2>
        <form id="upload-form" enctype="multipart/form-data">
            <div class="input-container">
                <label for="text">Text</label>
                <textarea id="text" name="text" rows="4" required></textarea>
            </div>
            <div class="input-container">
                <label for="file">Upload Image</label>
                <input type="file" id="file" name="file" accept="image/*" required>
            </div>
            <button type="submit">Upload</button>
            <div id="upload-message" class="error-message"></div>
        </form>
    </div>
    <script src="upload.js"></script>
</body>
</html>

<script>
    // Your Firebase configuration
const firebaseConfig = {
    apiKey: "AIzaSyBp7oS3gUpMzPOhyD4sAifXc2W65EqMoiw",
  authDomain: "mission-6cb34.firebaseapp.com",
  databaseURL: "https://mission-6cb34-default-rtdb.firebaseio.com",
  projectId: "mission-6cb34",
  storageBucket: "mission-6cb34.appspot.com",
  messagingSenderId: "737331310215",
  appId: "1:737331310215:web:61a99ae636095469c49222",
  measurementId: "G-9ZQ9NF8X8G"
};

// Initialize Firebase
firebase.initializeApp(firebaseConfig);
const storage = firebase.storage();
const database = firebase.database();

document.getElementById('upload-form').addEventListener('submit', function(event) {
    event.preventDefault();

    const text = document.getElementById('text').value;
    const file = document.getElementById('file').files[0];
    const uploadMessage = document.getElementById('upload-message');

    if (file) {
        const storageRef = storage.ref('images/' + file.name);
        const uploadTask = storageRef.put(file);

        uploadTask.on('state_changed',
            function(snapshot) {
                // Observe state change events such as progress, pause, and resume
            },
            function(error) {
                uploadMessage.textContent = 'Upload failed: ' + error.message;
            },
            function() {
                // Handle successful uploads on complete
                uploadTask.snapshot.ref.getDownloadURL().then(function(downloadURL) {
                    database.ref('content').push({
                        text: text,
                        imageUrl: downloadURL
                    }).then(() => {
                        uploadMessage.textContent = 'Upload successful!';
                        document.getElementById('upload-form').reset();
                    });
                });
            }
        );
    }
});

</script>